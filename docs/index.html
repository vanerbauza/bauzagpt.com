<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <meta name="theme-color" content="#000000" />
  <title>bauzagpt</title>

  <link rel="stylesheet" href="css/styles.css" />
</head>

<body>
  <main class="hero-minimal" id="inicio">
    <div class="hero-overlay" aria-hidden="true"></div>

    <section class="hero-center" aria-label="bauzagpt portada">
      <h1 class="brand">bauzagpt</h1>

      <div class="search-box" aria-label="búsqueda premium">
        <input id="q" type="text" inputmode="search" autocomplete="off"
          placeholder="escribe tu objetivo / dork / contexto" />
        <button id="btn-premium" type="button">búsqueda premium · 20 mxn</button>
      </div>

      <button id="btn-google" class="btn-wide" type="button" style="
        border:none; outline:none; cursor:pointer;
        border-radius: 999px;
        padding: .85rem 1.35rem;
        background: rgba(0,0,0,.92);
        border: 1px solid rgba(255,0,0,.75);
        color: #ff0000;
        font-weight: 900;
        text-transform: lowercase;
        box-shadow: 0 0 0 1px rgba(255,0,0,.12) inset, 0 16px 40px rgba(255,0,0,.14);
      ">acceso con google</button>

      <div class="meta-row">
        <span class="pill" id="session">sesión: no iniciada</span>
        <a class="go-down" href="#pasos">ver pasos ↓</a>
      </div>

      <div class="out" id="out" aria-live="polite"></div>

      <!-- ojos -->
      <div class="eyes" aria-hidden="true">
        <div class="eye left"><div class="pupil"></div></div>
        <div class="eye right"><div class="pupil"></div></div>
      </div>

      <div class="small-hint">
        tip: primero inicia sesión, luego ejecuta premium. “governance” antes del caos.
      </div>
    </section>
  </main>

  <section class="section" id="pasos">
    <div class="wrap">
      <h2 class="h2">pasos para usar la página</h2>
      <pre class="plain">1) inicia sesión con google (registro automático).
2) escribe tu objetivo / dork / contexto en el cuadro de búsqueda.
3) presiona "búsqueda premium · 20 mxn".
4) se envía a pago y confirmas (20 mxn por búsqueda).
5) se procesa la búsqueda y se arma el reporte.
6) recibes el pdf (link de descarga) y queda registro de la orden.

nota: esto es osint. magia no vendemos. claridad en input = calidad en output.</pre>
    </div>
  </section>

  <footer>
    <div class="legal">
      aviso legal: bauzagpt ofrece resultados informativos basados en fuentes públicas y/o insumos del usuario.
      no es asesoría legal ni garantía de resultados. el usuario es responsable del uso y del cumplimiento de leyes aplicables.
      precio: 20 mxn por búsqueda premium (pueden aplicar comisiones/impuestos del procesador).
      al usar este sitio aceptas términos, condiciones y política de privacidad.
    </div>
  </footer>

  <script type="module">
    const out = document.getElementById("out");
    const q = document.getElementById("q");
    const btnGoogle = document.getElementById("btn-google");
    const btnPremium = document.getElementById("btn-premium");
    const session = document.getElementById("session");

    const say = (m) => out.textContent = m;
    const fail = (m) => out.textContent = "error: " + m;
    const busy = (x) => { btnGoogle.disabled = x; btnPremium.disabled = x; };

    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.14.1/firebase-app.js";
    import { getAuth, GoogleAuthProvider, signInWithPopup, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/10.14.1/firebase-auth.js";

    // pega aquí tu config web de firebase (solo pública). no pongas claves secretas.
    const firebaseConfig = {
  apiKey: "AIzaSyD3a7cv735RQPYsXMdn4KWQ-NDugL7WyfI",
  authDomain: "studio-6473341422-75630.firebaseapp.com",
  projectId: "studio-6473341422-75630",
  storageBucket: "studio-6473341422-75630.firebasestorage.app",
  messagingSenderId: "240684953453",
  appId: "1:240684953453:web:6027f3b025c9ee22e8b464"
};

    const app = initializeApp(firebaseConfig);
    const auth = getAuth(app);
    const provider = new GoogleAuthProvider();

    let idToken = null;

    onAuthStateChanged(auth, async (user) => {
      if (!user) {
        idToken = null;
        session.textContent = "sesión: no iniciada";
        localStorage.removeItem("bauza_token");
        return;
      }
      idToken = await user.getIdToken();
      localStorage.setItem("bauza_token", idToken);
      session.textContent = "sesión: " + ((user.displayName || "usuario").toLowerCase());
      say("sesión iniciada. listo para premium.");
    });

    btnGoogle.addEventListener("click", async () => {
      try{
        busy(true);
        say("abriendo google…");
        const { user } = await signInWithPopup(auth, provider);
        idToken = await user.getIdToken();
        localStorage.setItem("bauza_token", idToken);
        say("sesión iniciada. ahora sí: búsqueda premium.");
      }catch(e){
        fail(e?.message || "no se pudo iniciar sesión");
      }finally{
        busy(false);
      }
    });

    btnPremium.addEventListener("click", () => {
      const query = (q.value || "").trim();
      if (!query) return fail("escribe algo en el cuadro de búsqueda.");
      if (!idToken) return fail("primero: acceso con google.");

      localStorage.setItem("bauza_query", query);

      // si ya tienes pago.html, lo mandamos ahí
      location.href = "pago.html?monto=20&q=" + encodeURIComponent(query);
    });

    q.addEventListener("keydown", (ev) => {
      if (ev.key === "Enter") btnPremium.click();
    });

    say("listo. inicia sesión y ejecuta tu búsqueda premium.");
  </script>
</body>
</html>
