<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <title>BauzaGPT — OSINT bajo demanda</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

  <!-- SEO básico -->
  <meta name="description" content="BauzaGPT es una plataforma OSINT que genera reportes PDF profesionales bajo demanda." />

  <!-- Estilos -->
  <link rel="stylesheet" href="./css/main.css" />

  <!-- Firebase SDK (v10 modular) -->
  <script type="module" src="./js/firebase-init.js"></script>
  <script type="module" src="./js/auth.js"></script>
  <script type="module" src="./js/orders.js"></script>
</head>

<body>

  <!-- ================= HEADER ================= -->
  <header class="topbar">
    <div class="logo">BauzaGPT</div>

    <div class="auth-area">
      <button id="loginBtn" class="btn primary">Iniciar sesión con Google</button>

      <div id="userBox" class="user-box hidden">
        <span id="userEmail"></span>
        <button id="logoutBtn" class="btn small">Salir</button>
      </div>
    </div>
  </header>

  <!-- ================= HERO ================= -->
  <section class="hero">
    <h1>OSINT profesional, rápido y verificable</h1>
    <p>Genera reportes OSINT en PDF por solo <b>$20 MXN</b> por búsqueda.</p>
  </section>

  <!-- ================= APP ================= -->
  <main class="app">

    <!-- Estado: NO autenticado -->
    <section id="guestSection" class="card">
      <h2>Comienza iniciando sesión</h2>
      <p>Usamos Google para identificarte de forma segura.</p>
      <button class="btn primary" onclick="loginWithGoogle()">Login con Google</button>
    </section>

    <!-- Estado: autenticado -->
    <section id="userSection" class="card hidden">

      <h2>Crear reporte OSINT</h2>

      <label for="targetInput">Objetivo (correo, usuario, dominio, etc.)</label>
      <input
        id="targetInput"
        type="text"
        placeholder="ej. test@example.com"
        class="input"
      />

      <button class="btn success" onclick="createOrder()">
        Generar reporte ($20 MXN)
      </button>

      <div id="orderResult" class="result-box hidden"></div>
    </section>

  </main>

  <!-- ================= FOOTER ================= -->
  <footer class="footer">
    <p>© 2025 BauzaGPT · OSINT responsable</p>
  </footer>

  <!-- ================= LOGIC ================= -->
  <script type="module">
    import { onAuthStateChanged, signOut } from "https://www.gstatic.com/firebasejs/10.12.3/firebase-auth.js";
    import { auth } from "./js/firebase-init.js";

    const loginBtn = document.getElementById("loginBtn");
    const logoutBtn = document.getElementById("logoutBtn");
    const userBox = document.getElementById("userBox");
    const userEmail = document.getElementById("userEmail");

    const guestSection = document.getElementById("guestSection");
    const userSection = document.getElementById("userSection");

    logoutBtn.addEventListener("click", async () => {
      await signOut(auth);
    });

    onAuthStateChanged(auth, (user) => {
      if (user) {
        loginBtn.classList.add("hidden");
        userBox.classList.remove("hidden");
        userEmail.textContent = user.email;

        guestSection.classList.add("hidden");
        userSection.classList.remove("hidden");
      } else {
        loginBtn.classList.remove("hidden");
        userBox.classList.add("hidden");

        guestSection.classList.remove("hidden");
        userSection.classList.add("hidden");
      }
    });
  </script>

</body>
</html>
